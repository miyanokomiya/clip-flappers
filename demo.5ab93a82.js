parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"vCxL":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.__extends=e,exports.__rest=n,exports.__decorate=o,exports.__param=a,exports.__metadata=i,exports.__awaiter=c,exports.__generator=u,exports.__exportStar=l,exports.__values=s,exports.__read=p,exports.__spread=y,exports.__spreadArrays=_,exports.__await=b,exports.__asyncGenerator=h,exports.__asyncDelegator=d,exports.__asyncValues=v,exports.__makeTemplateObject=w,exports.__importStar=m,exports.__importDefault=O,exports.__classPrivateFieldGet=g,exports.__classPrivateFieldSet=j,exports.__createBinding=exports.__assign=void 0;var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};function e(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}var r=function(){return exports.__assign=r=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},r.apply(this,arguments)};function n(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(r[n[o]]=t[n[o]])}return r}function o(t,e,r,n){var o,a=arguments.length,i=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,r,n);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(i=(a<3?o(i):a>3?o(e,r,i):o(e,r))||i);return a>3&&i&&Object.defineProperty(e,r,i),i}function a(t,e){return function(r,n){e(r,n,t)}}function i(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}function c(t,e,r,n){return new(r||(r=Promise))(function(o,a){function i(t){try{u(n.next(t))}catch(e){a(e)}}function c(t){try{u(n.throw(t))}catch(e){a(e)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(i,c)}u((n=n.apply(t,e||[])).next())})}function u(t,e){var r,n,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(a){return function(c){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;i;)try{if(r=1,n&&(o=2&a[0]?n.return:a[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,n=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=e.call(t,i)}catch(c){a=[6,c],n=0}finally{r=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}exports.__assign=r;var f=Object.create?function(t,e,r,n){void 0===n&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]};function l(t,e){for(var r in t)"default"===r||Object.prototype.hasOwnProperty.call(e,r)||f(e,t,r)}function s(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function p(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,a=r.call(t),i=[];try{for(;(void 0===e||e-- >0)&&!(n=a.next()).done;)i.push(n.value)}catch(c){o={error:c}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(o)throw o.error}}return i}function y(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(p(arguments[e]));return t}function _(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),o=0;for(e=0;e<r;e++)for(var a=arguments[e],i=0,c=a.length;i<c;i++,o++)n[o]=a[i];return n}function b(t){return this instanceof b?(this.v=t,this):new b(t)}function h(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(t,e||[]),a=[];return n={},i("next"),i("throw"),i("return"),n[Symbol.asyncIterator]=function(){return this},n;function i(t){o[t]&&(n[t]=function(e){return new Promise(function(r,n){a.push([t,e,r,n])>1||c(t,e)})})}function c(t,e){try{(r=o[t](e)).value instanceof b?Promise.resolve(r.value.v).then(u,f):l(a[0][2],r)}catch(n){l(a[0][3],n)}var r}function u(t){c("next",t)}function f(t){c("throw",t)}function l(t,e){t(e),a.shift(),a.length&&c(a[0][0],a[0][1])}}function d(t){var e,r;return e={},n("next"),n("throw",function(t){throw t}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(n,o){e[n]=t[n]?function(e){return(r=!r)?{value:b(t[n](e)),done:"return"===n}:o?o(e):e}:o}}function v(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,r=t[Symbol.asyncIterator];return r?r.call(t):(t="function"==typeof s?s(t):t[Symbol.iterator](),e={},n("next"),n("throw"),n("return"),e[Symbol.asyncIterator]=function(){return this},e);function n(r){e[r]=t[r]&&function(e){return new Promise(function(n,o){(function(t,e,r,n){Promise.resolve(n).then(function(e){t({value:e,done:r})},e)})(n,o,(e=t[r](e)).done,e.value)})}}}function w(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}exports.__createBinding=f;var x=Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e};function m(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)"default"!==r&&Object.prototype.hasOwnProperty.call(t,r)&&f(e,t,r);return x(e,t),e}function O(t){return t&&t.__esModule?t:{default:t}}function g(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function j(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}
},{}],"pHvP":[function(require,module,exports) {
function t(t,n,r){var i=!1,u=!1;return function(){u=r&&!i;var e=this,o=arguments;if(i||(i=!0,setTimeout(function(){if(i=!1,!r)return t.apply(e,o)},n)),u)return u=!1,t.apply(this,arguments)}}module.exports=t;
},{}],"qDjK":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.base64ToImage=l,exports.clipImage=m,exports.clipImageToBlob=_,exports.drawRectOnImage=E,exports.fileToBase64=f,exports.getCentralizedViewBox=a,exports.getPagePosition=h,exports.getPointInTarget=d,exports.getRate=o,exports.getTouchPointsInTarget=w,exports.getViewBoxMargin=i,exports.getViewBoxSize=r,exports.isMulitTouch=s,exports.isTouch=u,exports.isTouchExist=c,exports.useDrag=g,exports.useWindowPointerEffect=v;var e=require("tslib"),t=n(require("just-throttle"));function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!t)return{minRate:1,maxRate:1,rateW:1,rateH:1};var n=t.width/e.width,o=t.height/e.height;return{minRate:Math.min(n,o),maxRate:Math.max(n,o),rateW:n,rateH:o}}function r(e,t,n){return e?t>n?{width:e.width,height:e.height/n*t}:{width:e.width/t*n,height:e.height}:{width:1,height:1}}function i(e,t){return t?{x:(e.width-t.width)/2,y:(e.height-t.height)/2}:{x:0,y:0}}function a(t,n){if(!n)return(0,e.__assign)((0,e.__assign)({},t),{x:0,y:0});var a=o(t,n),u=r(n,a.rateW,a.rateH),s=i(u,n);return(0,e.__assign)({x:-s.x,y:-s.y},u)}function u(e){return"touches"in e}function s(e){return u(e)&&e.touches.length>1}function c(e){return u(e)&&e.touches.length>0}function h(e){return u(e)?{x:e.touches[0].pageX,y:e.touches[0].pageY}:{x:e.pageX,y:e.pageY}}function d(e){var t,n,o=e.currentTarget;if(!o)return{x:0,y:0};var r=o.getBoundingClientRect(),i=r.left+window.pageXOffset,a=r.top+window.pageYOffset;if(u(e)){var s=e.touches[0];t=s.pageX-i,n=s.pageY-a}else t=e.pageX-i,n=e.pageY-a;return{x:t,y:n}}function w(e){var t=e.currentTarget;if(!t)return[];for(var n=[],o=t.getBoundingClientRect(),r=o.left+window.pageXOffset,i=o.top+window.pageYOffset,a=0;a<e.touches.length;a++){var u=e.touches[a];n.push({x:u.pageX-r,y:u.pageY-i})}return n}function g(n,o){void 0===o&&(o=function(){});var r=!1,i=null,a=null,u=null,s=0,c=(0,t.default)(function(){r&&i&&u&&a&&(n({base:i,p:(0,e.__assign)({},u),d:{x:u.x-a.x,y:u.y-a.y}}),a=(0,e.__assign)({},u))},1e3/60,!0);return{onDown:function(t){r=!0,i=h(t),u=(0,e.__assign)({},i),a=(0,e.__assign)({},i),s=Date.now()},onMove:function(e){r&&(e.preventDefault(),u=h(e),c())},onUp:function(){u&&Date.now()-s<100?o((0,e.__assign)({},u)):r&&i&&u&&n({base:i,p:(0,e.__assign)({},u),d:{x:0,y:0}}),r=!1,i=null,u=null,a=null,s=0}}}function v(e){var t="ontouchstart"in window;return e.onDown&&(window.addEventListener("mousedown",e.onDown,!1),t&&window.addEventListener("touchstart",e.onDown,!1)),e.onMove&&(window.addEventListener("mousemove",e.onMove,!1),t&&window.addEventListener("touchmove",e.onMove,{capture:!1,passive:!1})),e.onUp&&(window.addEventListener("mouseup",e.onUp,!1),window.addEventListener("mouseleave",e.onUp,!1),t&&(window.addEventListener("touchend",e.onUp,!1),window.addEventListener("touchcancel",e.onUp,!1))),function(){e.onDown&&(window.removeEventListener("mousedown",e.onDown,!1),t&&window.removeEventListener("touchstart",e.onDown,!1)),e.onMove&&(window.removeEventListener("mousemove",e.onMove,!1),t&&window.removeEventListener("touchmove",e.onMove,{capture:!1})),e.onUp&&(window.removeEventListener("mouseup",e.onUp,!1),window.removeEventListener("mouseleave",e.onUp,!1),t&&(window.removeEventListener("touchend",e.onUp,!1),window.removeEventListener("touchcancel",e.onUp,!1)))}}function f(e){return new Promise(function(t,n){var o=new FileReader;o.onload=function(){return t(o.result)},o.onerror=n,o.readAsDataURL(e)})}function l(e){return new Promise(function(t,n){var o=new Image;o.onload=function(){return t(o)},o.onerror=n,o.src=e})}function p(t){return(0,e.__awaiter)(this,void 0,void 0,function(){return(0,e.__generator)(this,function(e){switch(e.label){case 0:return t instanceof Image?[2,t]:[4,l(t)];case 1:return[2,e.sent()]}})})}function x(t,n,o){return(0,e.__awaiter)(this,void 0,void 0,function(){var r,i,a,u;return(0,e.__generator)(this,function(e){switch(e.label){case 0:return r=null!=o?o:{width:n.width,height:n.height},[4,p(t)];case 1:if(i=e.sent(),(a=document.createElement("canvas")).width=r.width,a.height=r.height,!(u=a.getContext("2d")))throw new Error("Failed to get 2d-context from a canvas.");return u.drawImage(i,n.x,n.y,n.width,n.height,0,0,a.width,a.height),[2,a]}})})}function m(t,n,o){return(0,e.__awaiter)(this,void 0,void 0,function(){return(0,e.__generator)(this,function(e){switch(e.label){case 0:return[4,x(t,n,o)];case 1:return[2,e.sent().toDataURL()]}})})}function _(t,n,o){return(0,e.__awaiter)(this,void 0,void 0,function(){var r;return(0,e.__generator)(this,function(e){switch(e.label){case 0:return[4,x(t,n,o)];case 1:return r=e.sent(),[2,new Promise(function(e,t){r.toBlob(function(n){n&&e(n),t(new Error("Failed to create blob."))},"image/png")})]}})})}function E(t,n,o){return(0,e.__awaiter)(this,void 0,void 0,function(){var r,i,a;return(0,e.__generator)(this,function(e){switch(e.label){case 0:return[4,p(t)];case 1:if(r=e.sent(),(i=document.createElement("canvas")).width=r.width,i.height=r.height,!(a=i.getContext("2d")))throw new Error("Failed to get 2d-context from a canvas.");return a.drawImage(r,0,0,r.width,r.height),o?o(a):(a.strokeStyle="red",a.lineWidth=3),a.strokeRect(n.x,n.y,n.width,n.height),[2,i.toDataURL()]}})})}
},{"tslib":"vCxL","just-throttle":"pHvP"}],"fUdq":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=require("okanvas"),t=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function s(e){try{l(n.next(e))}catch(t){o(t)}}function a(e){try{l(n.throw(e))}catch(t){o(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(s,a)}l((n=n.apply(e,t||[])).next())})},i=function(e,t){var i,n,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,n&&(r=2&o[0]?n.return:o[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,o[1])).done)return r;switch(n=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(r=(r=s.trys).length>0&&r[r.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){s.label=o[1];break}if(6===o[0]&&s.label<r[1]){s.label=r[1],r=o;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(o);break}r[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(a){o=[6,a],n=0}finally{i=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},n="http://www.w3.org/2000/svg",r=function(e){return document.createElement(e)},o=function(e){return document.createElementNS(n,e)},s=function(e){return document.getElementById(e)};function a(e,t){e.setAttribute("style",Object.keys(t).map(function(e){return e+":"+t[e]+";"}).join(""))}var l=function(){function l(e,t){if(this.base64="",this.errorMessage="",this.errorMessages={invalidImageFile:"Invalid image file."},this.viewSize={width:124,height:124},e instanceof Element)this.$el=e;else{var i=s(e);if(!(i instanceof Element))throw new Error("Failed to mount target: "+e);this.$el=i}(null==t?void 0:t.errorMessages)&&(this.errorMessages=t.errorMessages),(null==t?void 0:t.viewSize)&&(this.viewSize=t.viewSize),this.render()}return l.prototype.render=function(){var e=this,t=r("div"),i=r("input");i.setAttribute("type","file"),i.setAttribute("accept","image/*"),i.oninput=function(t){return e.onInputFile(t)},t.appendChild(i);var s=r("button");s.innerText="Select",s.onclick=function(){return i.click()},t.appendChild(s);var l=r("div");a(l,{padding:"8px",border:"1px solid #000",backgroundColor:"#ccc",overflow:"hidden"}),l.style.width=this.viewSize.width+"px",l.style.height=this.viewSize.height+"px";var u=o("svg");u.setAttribute("xmlns",n),u.setAttribute("viewBox","0 0 100 100"),u.style.width="100%",u.style.height="100%",l.appendChild(u),t.appendChild(l),this.$el.appendChild(t)},l.prototype.updateImage=function(){var n,r;return t(this,void 0,void 0,function(){var t,s,a;return i(this,function(i){switch(i.label){case 0:return[4,(0,e.base64ToImage)(this.base64)];case 1:return t=i.sent(),(s=o("image")).setAttribute("href",this.base64),s.setAttribute("x","0"),s.setAttribute("y","0"),s.setAttribute("width",""+t.width),s.setAttribute("height",""+t.height),a=this.$el.getElementsByTagName("svg"),null===(n=a[0])||void 0===n||n.setAttribute("viewBox","0 0 "+t.width+" "+t.height),null===(r=a[0])||void 0===r||r.appendChild(s),[2]}})})},l.prototype.onInputFile=function(n){var r;return t(this,void 0,void 0,function(){var t;return i(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),(null===(r=null==n?void 0:n.target)||void 0===r?void 0:r.files)?(t=this,[4,(0,e.fileToBase64)(n.target.files[0])]):[2];case 1:return t.base64=i.sent(),this.updateImage(),[3,3];case 2:return i.sent(),this.errorMessage=this.errorMessages.invalidImageFile,[3,3];case 3:return[2]}})})},l.prototype.dispose=function(){var e;(null===(e=this.$el)||void 0===e?void 0:e.parentElement)&&this.$el.parentElement.removeChild(this.$el),this.$el=null},l}(),u=l;exports.default=u;
},{"okanvas":"qDjK"}],"QCba":[function(require,module,exports) {
"use strict";var e,t=i(require("../src/index"));function i(e){return e&&e.__esModule?e:{default:e}}var n=new t.default("target",{viewSize:{width:300,height:200}});null===(e=document.getElementById("dispose"))||void 0===e||e.addEventListener("click",function(){null==n||n.dispose()});
},{"../src/index":"fUdq"}]},{},["QCba"], null)
//# sourceMappingURL=demo.5ab93a82.js.map