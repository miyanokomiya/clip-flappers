parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"vCxL":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.__extends=e,exports.__rest=n,exports.__decorate=o,exports.__param=a,exports.__metadata=i,exports.__awaiter=c,exports.__generator=u,exports.__exportStar=l,exports.__values=s,exports.__read=p,exports.__spread=y,exports.__spreadArrays=_,exports.__await=b,exports.__asyncGenerator=h,exports.__asyncDelegator=d,exports.__asyncValues=v,exports.__makeTemplateObject=w,exports.__importStar=m,exports.__importDefault=O,exports.__classPrivateFieldGet=g,exports.__classPrivateFieldSet=j,exports.__createBinding=exports.__assign=void 0;var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};function e(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}var r=function(){return exports.__assign=r=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},r.apply(this,arguments)};function n(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(r[n[o]]=t[n[o]])}return r}function o(t,e,r,n){var o,a=arguments.length,i=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,r,n);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(i=(a<3?o(i):a>3?o(e,r,i):o(e,r))||i);return a>3&&i&&Object.defineProperty(e,r,i),i}function a(t,e){return function(r,n){e(r,n,t)}}function i(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}function c(t,e,r,n){return new(r||(r=Promise))(function(o,a){function i(t){try{u(n.next(t))}catch(e){a(e)}}function c(t){try{u(n.throw(t))}catch(e){a(e)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(i,c)}u((n=n.apply(t,e||[])).next())})}function u(t,e){var r,n,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(a){return function(c){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;i;)try{if(r=1,n&&(o=2&a[0]?n.return:a[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,n=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=e.call(t,i)}catch(c){a=[6,c],n=0}finally{r=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}exports.__assign=r;var f=Object.create?function(t,e,r,n){void 0===n&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]};function l(t,e){for(var r in t)"default"===r||Object.prototype.hasOwnProperty.call(e,r)||f(e,t,r)}function s(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function p(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,a=r.call(t),i=[];try{for(;(void 0===e||e-- >0)&&!(n=a.next()).done;)i.push(n.value)}catch(c){o={error:c}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(o)throw o.error}}return i}function y(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(p(arguments[e]));return t}function _(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),o=0;for(e=0;e<r;e++)for(var a=arguments[e],i=0,c=a.length;i<c;i++,o++)n[o]=a[i];return n}function b(t){return this instanceof b?(this.v=t,this):new b(t)}function h(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(t,e||[]),a=[];return n={},i("next"),i("throw"),i("return"),n[Symbol.asyncIterator]=function(){return this},n;function i(t){o[t]&&(n[t]=function(e){return new Promise(function(r,n){a.push([t,e,r,n])>1||c(t,e)})})}function c(t,e){try{(r=o[t](e)).value instanceof b?Promise.resolve(r.value.v).then(u,f):l(a[0][2],r)}catch(n){l(a[0][3],n)}var r}function u(t){c("next",t)}function f(t){c("throw",t)}function l(t,e){t(e),a.shift(),a.length&&c(a[0][0],a[0][1])}}function d(t){var e,r;return e={},n("next"),n("throw",function(t){throw t}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(n,o){e[n]=t[n]?function(e){return(r=!r)?{value:b(t[n](e)),done:"return"===n}:o?o(e):e}:o}}function v(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,r=t[Symbol.asyncIterator];return r?r.call(t):(t="function"==typeof s?s(t):t[Symbol.iterator](),e={},n("next"),n("throw"),n("return"),e[Symbol.asyncIterator]=function(){return this},e);function n(r){e[r]=t[r]&&function(e){return new Promise(function(n,o){(function(t,e,r,n){Promise.resolve(n).then(function(e){t({value:e,done:r})},e)})(n,o,(e=t[r](e)).done,e.value)})}}}function w(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}exports.__createBinding=f;var x=Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e};function m(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)"default"!==r&&Object.prototype.hasOwnProperty.call(t,r)&&f(e,t,r);return x(e,t),e}function O(t){return t&&t.__esModule?t:{default:t}}function g(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function j(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}
},{}],"pHvP":[function(require,module,exports) {
function t(t,n,r){var i=!1,u=!1;return function(){u=r&&!i;var e=this,o=arguments;if(i||(i=!0,setTimeout(function(){if(i=!1,!r)return t.apply(e,o)},n)),u)return u=!1,t.apply(this,arguments)}}module.exports=t;
},{}],"qDjK":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.base64ToImage=l,exports.clipImage=m,exports.clipImageToBlob=_,exports.drawRectOnImage=E,exports.fileToBase64=f,exports.getCentralizedViewBox=a,exports.getPagePosition=h,exports.getPointInTarget=d,exports.getRate=o,exports.getTouchPointsInTarget=w,exports.getViewBoxMargin=i,exports.getViewBoxSize=r,exports.isMulitTouch=s,exports.isTouch=u,exports.isTouchExist=c,exports.useDrag=g,exports.useWindowPointerEffect=v;var e=require("tslib"),t=n(require("just-throttle"));function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!t)return{minRate:1,maxRate:1,rateW:1,rateH:1};var n=t.width/e.width,o=t.height/e.height;return{minRate:Math.min(n,o),maxRate:Math.max(n,o),rateW:n,rateH:o}}function r(e,t,n){return e?t>n?{width:e.width,height:e.height/n*t}:{width:e.width/t*n,height:e.height}:{width:1,height:1}}function i(e,t){return t?{x:(e.width-t.width)/2,y:(e.height-t.height)/2}:{x:0,y:0}}function a(t,n){if(!n)return(0,e.__assign)((0,e.__assign)({},t),{x:0,y:0});var a=o(t,n),u=r(n,a.rateW,a.rateH),s=i(u,n);return(0,e.__assign)({x:-s.x,y:-s.y},u)}function u(e){return"touches"in e}function s(e){return u(e)&&e.touches.length>1}function c(e){return u(e)&&e.touches.length>0}function h(e){return u(e)?{x:e.touches[0].pageX,y:e.touches[0].pageY}:{x:e.pageX,y:e.pageY}}function d(e){var t,n,o=e.currentTarget;if(!o)return{x:0,y:0};var r=o.getBoundingClientRect(),i=r.left+window.pageXOffset,a=r.top+window.pageYOffset;if(u(e)){var s=e.touches[0];t=s.pageX-i,n=s.pageY-a}else t=e.pageX-i,n=e.pageY-a;return{x:t,y:n}}function w(e){var t=e.currentTarget;if(!t)return[];for(var n=[],o=t.getBoundingClientRect(),r=o.left+window.pageXOffset,i=o.top+window.pageYOffset,a=0;a<e.touches.length;a++){var u=e.touches[a];n.push({x:u.pageX-r,y:u.pageY-i})}return n}function g(n,o){void 0===o&&(o=function(){});var r=!1,i=null,a=null,u=null,s=0,c=(0,t.default)(function(){r&&i&&u&&a&&(n({base:i,p:(0,e.__assign)({},u),d:{x:u.x-a.x,y:u.y-a.y}}),a=(0,e.__assign)({},u))},1e3/60,!0);return{onDown:function(t){r=!0,i=h(t),u=(0,e.__assign)({},i),a=(0,e.__assign)({},i),s=Date.now()},onMove:function(e){r&&(e.preventDefault(),u=h(e),c())},onUp:function(){u&&Date.now()-s<100?o((0,e.__assign)({},u)):r&&i&&u&&n({base:i,p:(0,e.__assign)({},u),d:{x:0,y:0}}),r=!1,i=null,u=null,a=null,s=0}}}function v(e){var t="ontouchstart"in window;return e.onDown&&(window.addEventListener("mousedown",e.onDown,!1),t&&window.addEventListener("touchstart",e.onDown,!1)),e.onMove&&(window.addEventListener("mousemove",e.onMove,!1),t&&window.addEventListener("touchmove",e.onMove,{capture:!1,passive:!1})),e.onUp&&(window.addEventListener("mouseup",e.onUp,!1),window.addEventListener("mouseleave",e.onUp,!1),t&&(window.addEventListener("touchend",e.onUp,!1),window.addEventListener("touchcancel",e.onUp,!1))),function(){e.onDown&&(window.removeEventListener("mousedown",e.onDown,!1),t&&window.removeEventListener("touchstart",e.onDown,!1)),e.onMove&&(window.removeEventListener("mousemove",e.onMove,!1),t&&window.removeEventListener("touchmove",e.onMove,{capture:!1})),e.onUp&&(window.removeEventListener("mouseup",e.onUp,!1),window.removeEventListener("mouseleave",e.onUp,!1),t&&(window.removeEventListener("touchend",e.onUp,!1),window.removeEventListener("touchcancel",e.onUp,!1)))}}function f(e){return new Promise(function(t,n){var o=new FileReader;o.onload=function(){return t(o.result)},o.onerror=n,o.readAsDataURL(e)})}function l(e){return new Promise(function(t,n){var o=new Image;o.onload=function(){return t(o)},o.onerror=n,o.src=e})}function p(t){return(0,e.__awaiter)(this,void 0,void 0,function(){return(0,e.__generator)(this,function(e){switch(e.label){case 0:return t instanceof Image?[2,t]:[4,l(t)];case 1:return[2,e.sent()]}})})}function x(t,n,o){return(0,e.__awaiter)(this,void 0,void 0,function(){var r,i,a,u;return(0,e.__generator)(this,function(e){switch(e.label){case 0:return r=null!=o?o:{width:n.width,height:n.height},[4,p(t)];case 1:if(i=e.sent(),(a=document.createElement("canvas")).width=r.width,a.height=r.height,!(u=a.getContext("2d")))throw new Error("Failed to get 2d-context from a canvas.");return u.drawImage(i,n.x,n.y,n.width,n.height,0,0,a.width,a.height),[2,a]}})})}function m(t,n,o){return(0,e.__awaiter)(this,void 0,void 0,function(){return(0,e.__generator)(this,function(e){switch(e.label){case 0:return[4,x(t,n,o)];case 1:return[2,e.sent().toDataURL()]}})})}function _(t,n,o){return(0,e.__awaiter)(this,void 0,void 0,function(){var r;return(0,e.__generator)(this,function(e){switch(e.label){case 0:return[4,x(t,n,o)];case 1:return r=e.sent(),[2,new Promise(function(e,t){r.toBlob(function(n){n&&e(n),t(new Error("Failed to create blob."))},"image/png")})]}})})}function E(t,n,o){return(0,e.__awaiter)(this,void 0,void 0,function(){var r,i,a;return(0,e.__generator)(this,function(e){switch(e.label){case 0:return[4,p(t)];case 1:if(r=e.sent(),(i=document.createElement("canvas")).width=r.width,i.height=r.height,!(a=i.getContext("2d")))throw new Error("Failed to get 2d-context from a canvas.");return a.drawImage(r,0,0,r.width,r.height),o?o(a):(a.strokeStyle="red",a.lineWidth=3),a.strokeRect(n.x,n.y,n.width,n.height),[2,i.toDataURL()]}})})}
},{"tslib":"vCxL","just-throttle":"pHvP"}],"SGr5":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getResetStyles=o,exports.appendChildren=i,exports.createHTMLElement=a,exports.createSVGElement=s,exports.createElement=c,exports.setStyles=l,exports.createClipRectElm=u,exports.createSvgWrapperElm=d,exports.createSvg=p,exports.createPhotoSVG=h,exports.createDeleteSVG=f,exports.show=x,exports.hide=g,exports.setAttribute=exports.appendChild=exports.g=void 0;var t="http://www.w3.org/2000/svg",e=function(t){return document.getElementById(t)};exports.g=e;var r=function(t,e){return t.appendChild(e)};exports.appendChild=r;var n=function(t,e,r){return t.setAttribute(e,r)};function o(){return{padding:"0",margin:"0",border:"none","background-color":"transparent"}}function i(t,e){var n=document.createDocumentFragment();return e.forEach(function(t){return r(n,t)}),r(t,n),t}function a(t,e,r){return void 0===e&&(e=null),void 0===r&&(r=[]),c(document.createElement(t),e,r)}function s(e,r,n){return void 0===r&&(r=null),void 0===n&&(n=[]),c(document.createElementNS(t,e),r,n)}function c(t,e,r){for(var o in void 0===e&&(e=null),void 0===r&&(r=[]),e){var i=e[o];"function"==typeof i?t[o]=i:n(t,o,e[o].toString())}if(Array.isArray(r)){for(var a=document.createDocumentFragment(),s=0;s<r.length;s++)a.appendChild(r[s]);t.appendChild(a)}else t.textContent=r;return t}function l(t,e){t&&t.setAttribute("style",Object.keys(e).map(function(t){return t+":"+e[t]+";"}).join(""))}function u(t,e,r){var n=s("g",null,[s("circle",{cx:0,cy:0,r:8*e,fill:"red",stroke:"none",onmousedown:r.onStartMove,ontouchstart:r.onStartMove})]),o=s("g",{transform:"translate("+t.width+", "+t.height+")"},[s("circle",{cx:0,cy:0,r:8*e,fill:"red",stroke:"none",onmousedown:r.onStartResize,ontouchstart:r.onStartResize})]);return s("g",{transform:"translate("+t.x+", "+t.y+")"},[s("rect",{x:0,y:0,width:t.width,height:t.height,fill:"none",stroke:"red","stroke-width":4*e}),n,o])}function d(t){var e=a("div");return l(e,{padding:"8px",border:"1px solid #000",backgroundColor:"#ccc",overflow:"hidden",position:"relative",width:t.width+"px",height:t.height+"px"}),e}function p(){var t=s("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 100 100"});return l(t,{overflow:"visible",width:"100%",height:"100%"}),t}function h(){return i(p(),[s("g",{transform:"translate(25,25)"},[s("g",{fill:"#aaa"},[s("path",{d:"M0,45 L0,40 L15,25 L20,30 L30,20 L50,40 L50,45z"}),s("circle",{cx:"10",cy:"15",r:"4"})]),s("rect",{width:"50",height:"50",rx:"4",ry:"4",fill:"none",stroke:"#aaa","stroke-width":"2"})])])}function f(){return i(p(),[s("g",null,[s("path",{d:"M24,24 L76,76 M24,76 L76,24",fill:"none",stroke:"#aaa","stroke-width":12}),s("circle",{cx:50,cy:50,r:50,fill:"none",stroke:"#aaa","stroke-width":10})])])}function x(t,e){return t&&(t.style.display=null!=e?e:""),t}function g(t){return t&&(t.style.display="none"),t}exports.setAttribute=n;
},{}],"fUdq":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ClipFlappers=exports.base64ToImage=exports.clipImage=void 0;var e=require("okanvas"),t=require("./el"),i=function(){return(i=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},r=function(e,t,i,r){return new(i||(i=Promise))(function(n,s){function o(e){try{a(r.next(e))}catch(t){s(t)}}function l(e){try{a(r.throw(e))}catch(t){s(t)}}function a(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(o,l)}a((r=r.apply(e,t||[])).next())})},n=function(e,t){var i,r,n,s,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return s={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function l(s){return function(l){return function(s){if(i)throw new TypeError("Generator is already executing.");for(;o;)try{if(i=1,r&&(n=2&s[0]?r.return:s[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,s[1])).done)return n;switch(r=0,n&&(s=[2&s[0],n.value]),s[0]){case 0:case 1:n=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(n=(n=o.trys).length>0&&n[n.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!n||s[1]>n[0]&&s[1]<n[3])){o.label=s[1];break}if(6===s[0]&&o.label<n[1]){o.label=n[1],n=s;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(s);break}n[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(l){s=[6,l],r=0}finally{i=n=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},s=e.clipImage;exports.clipImage=s;var o=e.base64ToImage;exports.base64ToImage=o;var l="clip-f",a=function(){function a(e,r){var n=this;if(this.$svg=null,this.$clipRect=null,this.base64="",this.image=null,this.errorMessages={invalidImageFile:"Invalid image file."},this.errorTimer=0,this.viewSize={width:124,height:124},this.clipSize={width:124,height:124},this.disposeWindowPointer=function(){},this.dragMode="",this.clipRect=null,this.clipRectOrg=null,this.dragListeners=null,this.onUpdateClip=null,this.onUp=function(){n.dragListeners&&(n.dragListeners.onUp(),n.clipRectOrg&&n.onCompleteClip(),n.dragMode="",n.clipRectOrg=null)},this.onStartMove=function(e){n.clipRect&&n.dragListeners&&(n.dragMode="move",n.clipRectOrg=i({},n.clipRect),n.dragListeners.onDown(e))},this.onStartResize=function(e){n.clipRect&&n.dragListeners&&(n.dragMode="resize",n.clipRectOrg=i({},n.clipRect),n.dragListeners.onDown(e))},e instanceof Element)this.$el=e;else{var s=(0,t.g)(e);if(!(s instanceof Element))throw new Error("Failed to mount target: "+e);this.$el=s}(null==r?void 0:r.errorMessages)&&(this.errorMessages=r.errorMessages),(null==r?void 0:r.viewSize)&&(this.viewSize=r.viewSize),(null==r?void 0:r.clipSize)&&(this.clipSize=r.clipSize),(null==r?void 0:r.onUpdateClip)&&(this.onUpdateClip=r.onUpdateClip),this.render()}return a.prototype.dispose=function(){this.$el.innerHTML="",this.$el=null,this.$svg=null,this.$clipRect=null,this.image=null,this.disposeWindowPointer(),this.dragListeners=null},a.prototype.reset=function(){this.$clipRect=null,this.image=null,this.disposeWindowPointer(),this.dragListeners=null,this.$svg.innerHTML="",(0,t.hide)(this.$svg),(0,t.show)(this.getElement("drop-button")),(0,t.hide)(this.getElement("delete-button"))},a.prototype.clip=function(){return r(this,void 0,Promise,function(){return n(this,function(e){if(!this.image||!this.clipRect)throw new Error("image not loaded");return[2,s(this.image,this.clipRect,this.clipSize)]})})},a.prototype.getElement=function(e){return this.$el.querySelector('[data-key="'+l+"_"+e+'"]')},a.prototype.render=function(){var e=this,r=(0,t.createHTMLElement)("input",{type:"file",accept:"image/*",oninput:function(t){return e.onInputFile(t)}});(0,t.hide)(r);var n=(0,t.createHTMLElement)("button",i({onclick:function(){return r.click()}},h("drop-button")),[(0,t.createPhotoSVG)()]);(0,t.setStyles)(n,i(i({},(0,t.getResetStyles)()),{width:"100%",height:"100%",cursor:"pointer"}));var s=(0,t.createHTMLElement)("button",i({onclick:function(){return e.reset()}},h("delete-button")),[(0,t.createDeleteSVG)()]);(0,t.setStyles)(s,i(i({},(0,t.getResetStyles)()),{position:"absolute",top:"4px",right:"4px",width:"20px",height:"20px","border-radius":"100%",cursor:"pointer"})),(0,t.hide)(s);var o=(0,t.createHTMLElement)("p",i(i({},h("error")),{onclick:function(){return e.hideError()}}));(0,t.setStyles)(o,i(i({},(0,t.getResetStyles)()),{position:"absolute",bottom:"0",left:"0",right:"0",padding:"4px 8px",color:"white","background-color":"red","font-size":"16px","word-break":"break-all",cursor:"pointer",transition:"0.5s all",transform:"translateY(100%)"}));var l=(0,t.createSvgWrapperElm)(this.viewSize);l.ondragover=function(e){e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect="copy"),l.style.opacity="0.7"},l.ondragleave=function(e){e.preventDefault(),l.style.opacity=""},l.ondrop=function(t){t.preventDefault(),l.style.opacity="",e.onInputFile(t)},this.$svg=(0,t.createSvg)(),(0,t.hide)(this.$svg),(0,t.appendChildren)(this.$el,[(0,t.appendChildren)((0,t.createHTMLElement)("div",null,[]),[r,(0,t.appendChildren)(l,[this.$svg,n,s,o])])])},a.prototype.updateImage=function(s){return r(this,void 0,void 0,function(){var r,l,a,c,h,p=this;return n(this,function(n){switch(n.label){case 0:r=null,n.label=1;case 1:return n.trys.push([1,3,,4]),[4,o(s)];case 2:return r=n.sent(),[3,4];case 3:return n.sent(),this.setErrorMessage("invalidImageFile"),[3,4];case 4:return r?(this.base64=s,this.image=r,l=(0,e.getCentralizedViewBox)(this.clipSize,r),(a=this.$svg).innerHTML="",(0,t.show)(a),(0,t.setAttribute)(a,"viewBox",l.x+" "+l.y+" "+l.width+" "+l.height),(0,t.hide)(this.getElement("drop-button")),(0,t.show)(this.getElement("delete-button")),c=(0,e.getRate)(this.viewSize,(0,e.getCentralizedViewBox)(this.clipSize,r)).maxRate,h=(0,e.useDrag)(function(e){return p.onDrag(e,c)}),this.dragListeners=h,this.disposeWindowPointer(),this.disposeWindowPointer=(0,e.useWindowPointerEffect)({onMove:h.onMove,onUp:this.onUp}),this.clipRect=i({},l),this.$clipRect=(0,t.createClipRectElm)(this.clipRect,c,{onStartMove:this.onStartMove,onStartResize:this.onStartResize}),(0,t.appendChildren)(a,[(0,t.createSVGElement)("image",{x:0,y:0,width:r.width,height:r.height,href:this.base64}),this.$clipRect]),[2]):[2]}})})},a.prototype.updateClipRect=function(i){if(this.$svg&&this.$clipRect&&this.image&&this.clipRect){var r=(0,e.getRate)(this.viewSize,(0,e.getCentralizedViewBox)(this.clipSize,this.image)).maxRate,n=(0,t.createClipRectElm)(this.clipRect,r,{onStartMove:this.onStartMove,onStartResize:this.onStartResize});this.$svg.removeChild(this.$clipRect),(0,t.appendChild)(this.$svg,n),this.clipRect=i,this.$clipRect=n}},a.prototype.onCompleteClip=function(){return r(this,void 0,void 0,function(){return n(this,function(e){return this.image&&this.clipRect?(this.onUpdateClip&&this.onUpdateClip(this.base64,this.clipRect,this.clipSize),[2]):[2]})})},a.prototype.onDrag=function(e,t){var r=this.dragMode,n=this.clipRectOrg,s=this.clipSize;if(r&&n)if("move"===r)this.updateClipRect(i(i({},n),{x:n.x+(e.p.x-e.base.x)*t,y:n.y+(e.p.y-e.base.y)*t}));else if("resize"===r){var o=c({x:n.width+(e.p.x-e.base.x)*t,y:n.height+(e.p.y-e.base.y)*t},{x:0,y:0},{x:s.width,y:s.height});this.updateClipRect(i(i({},n),{width:o.x,height:o.y}))}},a.prototype.onInputFile=function(t){var i,s,o;return r(this,void 0,void 0,function(){var r,l;return n(this,function(n){switch(n.label){case 0:if(!(r=null!==(s=null===(i=null==t?void 0:t.target)||void 0===i?void 0:i.files)&&void 0!==s?s:null===(o=t.dataTransfer)||void 0===o?void 0:o.files))return[2];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,(0,e.fileToBase64)(r[0])];case 2:return l=n.sent(),this.updateImage(l),[3,4];case 3:return n.sent(),this.setErrorMessage("invalidImageFile"),[3,4];case 4:return[2]}})})},a.prototype.setErrorMessage=function(e){var t=this,i=this.getElement("error");i&&(i.textContent=this.errorMessages[e],i.style.transform="",clearTimeout(this.errorTimer),this.errorTimer=setTimeout(function(){return t.hideError()},5e3))},a.prototype.hideError=function(){var e=this.getElement("error");e&&(e.style.transform="translateY(100%)",clearTimeout(this.errorTimer),this.errorTimer=0)},a}();function c(e,t,i){var r=i,n=e.x-t.x,s=e.y-t.y,o=r.x*r.x+r.y*r.y,l=(r.x*n+r.y*s)/o;return{x:r.x*l,y:r.y*l}}function h(e){return{"data-key":l+"_"+e}}exports.ClipFlappers=a;
},{"okanvas":"qDjK","./el":"SGr5"}],"QCba":[function(require,module,exports) {
"use strict";var n,e,t=require("../src/index"),r=function(n,e,t,r){return new(t||(t=Promise))(function(i,o){function u(n){try{l(r.next(n))}catch(e){o(e)}}function c(n){try{l(r.throw(n))}catch(e){o(e)}}function l(n){var e;n.done?i(n.value):(e=n.value,e instanceof t?e:new t(function(n){n(e)})).then(u,c)}l((r=r.apply(n,e||[])).next())})},i=function(n,e){var t,r,i,o,u={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(t)throw new TypeError("Generator is already executing.");for(;u;)try{if(t=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return u.label++,{value:o[1],done:!1};case 5:u.label++,r=o[1],o=[0];continue;case 7:o=u.ops.pop(),u.trys.pop();continue;default:if(!(i=(i=u.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){u=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){u.label=o[1];break}if(6===o[0]&&u.label<i[1]){u.label=i[1],i=o;break}if(i&&u.label<i[2]){u.label=i[2],u.ops.push(o);break}i[2]&&u.ops.pop(),u.trys.pop();continue}o=e.call(n,u)}catch(c){o=[6,c],r=0}finally{t=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}};function o(n){return r(this,void 0,void 0,function(){var e;return i(this,function(t){return(e=new Image).onload=function(){e.style.border="solid 1px black",e.style.margin="2px",document.body.appendChild(e)},e.src=n,[2]})})}function u(n,e,u){return r(this,void 0,void 0,function(){return i(this,function(r){switch(r.label){case 0:return[4,(0,t.clipImage)(n,e,u)];case 1:return o(r.sent()),[2]}})})}var c=new t.ClipFlappers("target",{viewSize:{width:300,height:200},onUpdateClip:u});null===(n=document.getElementById("dispose"))||void 0===n||n.addEventListener("click",function(){null==c||c.dispose()}),null===(e=document.getElementById("clip"))||void 0===e||e.addEventListener("click",function(){return r(void 0,void 0,void 0,function(){return i(this,function(n){switch(n.label){case 0:return[4,null==c?void 0:c.clip()];case 1:return o(n.sent()),[2]}})})});
},{"../src/index":"fUdq"}]},{},["QCba"], null)
//# sourceMappingURL=demo.62784e6f.js.map